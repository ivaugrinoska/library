<body xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">

<div class="container-fluid">
    <main class="tm-main">
        <!-- Search form -->
        <div class="row tm-row">
            <div class="col-12">
                <form th:method="GET" th:action="@{/books/search}" class="form-inline tm-mb-80 tm-search-form">
                    <input class="form-control tm-search-input" name="authorOrTitle" type="text"
                           placeholder="Пребарај по наслов/автор..." aria-label="Search">
                    <button class="tm-search-button" type="submit">
                        <span class="glyphicon glyphicon-search"></span>
                    </button>
                </form>
            </div>
        </div>


        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <!-- Container wrapper -->
            <div class="container-fluid">
                <!-- Toggle button -->
                <button
                        class="navbar-toggler"
                        type="button"
                        data-mdb-toggle="collapse"
                        data-mdb-target="#navbarSupportedContent"
                        aria-controls="navbarSupportedContent"
                        aria-expanded="false"
                        aria-label="Toggle navigation"
                >
                    <i class="fas fa-bars"></i>
                </button>

                <!-- Collapsible wrapper -->
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <!-- Navbar brand -->
                    <a class="navbar-brand mt-2 mt-lg-0 active" th:href="@{/}">
                        <img
                                src="https://wareham.theweektoday.com/sites/beaverdam/files/2014/10/field/image/Friends%20logo.png"
                                height="55"
                                width="50"
                                alt="Library Logo"
                                loading="lazy"
                        />
                    </a>
                    <!-- Left links -->
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/books/topRated}">Најдобро рангирани</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" th:href="@{/help}">Помош</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" sec:authorize="hasRole('ROLE_LIBRARIAN')" th:href="@{/books/add-form}">Додади книга</a>
                        </li>
                    </ul>
                    <!-- Left links -->
                </div>
                <!-- Right elements -->
                <div class="d-flex align-items-center">
                    <!-- Icon -->
                    <a  class="text-reset me-3" href="#" f>
                        <i class="fas fa-shopping-cart"></i>
                    </a>
                    <!-- Notifications -->
                    <!--                    ovoj dropdown ne raboti, samo linkot so span vgnezden za kosnicka raboti :(-->
<!--                    <div class="dropdown" sec:authorize="isAuthenticated()">-->
                        <button sec:authorize="hasRole('ROLE_USER')" class="dropbtn" >
                            <a th:href="@{/reservations/current}" style="margin-right: 5px">
                                <span class="glyphicon glyphicon-shopping-cart"></span>
                            </a></button>
<!--                    </div>-->
                    <!-- Avatar -->
                    <!--                    ova da se gleda samo korisnikot koga e najaven, inaku da gleda registracija/najava-->
<!--                    <div class="dropdown" sec:authorize="isAuthenticated()">-->
                    <div class="dropdown">
                        <button class="dropbtn"> <a>
                            <span class="glyphicon glyphicon-user"></span>
                        </a></button>
                        <div class="dropdown-content">
                            <a th:href="@{/users/profile}">Профил</a>
                            <a href="/logout">Одјави се</a>
                        </div>
                    </div>

                    <!-- Right elements -->
                </div>
                <!-- Container wrapper -->
            </div>
        </nav>
<!--        <div class="row tm-row">-->
<!--            <article th:each="book: ${books}" class="col-12 col-md-4 tm-post" style="width: 300px;">-->
<!--                <hr class="tm-hr-primary">-->
<!--                <a th:href="@{'/books/{id}' (id=${book.getId()})}" class="effect-lily tm-post-link tm-pt-60">-->
<!--                    <div class="tm-post-link-inner">-->

<!--                        <img th:src="${book.getUrl()}" style="width: 300px; height: 400px;" alt="Image"-->
<!--                             class="img-fluid">-->
<!--                    </div>-->
<!--                    &lt;!&ndash;<span class="position-absolute tm-new-badge">Recommended</span>&ndash;&gt;-->
<!--                    <h2 class="tm-pt-30 tm-color-primary tm-post-title" th:text="${book.getName()}"></h2>-->
<!--                </a>-->
<!--                <div class="d-flex justify-content-between tm-pt-45">-->
<!--                    <span class="tm-color-primary" th:text="${book.getAuthor()}"></span>-->
<!--                    &lt;!&ndash;                    <span class="tm-color-primary">June 24, 2020</span>&ndash;&gt;-->
<!--                </div>-->
<!--                <hr>-->
<!--                <div class="d-flex justify-content-between">-->
<!--                    <span th:text="${book.getStock()}"></span>-->
<!--                    <span th:text="${book.getRating()}"></span>-->
<!--                </div>-->
<!--            </article>-->

<!--        </div>-->
<!--        <div class="row tm-row tm-mt-100 tm-mb-75">-->
<!--            <div class="tm-prev-next-wrapper">-->
<!--                <a href="#" class="mb-2 tm-btn tm-btn-primary tm-prev-next disabled tm-mr-20">Prev</a>-->
<!--                <a href="#" class="mb-2 tm-btn tm-btn-primary tm-prev-next">Next</a>-->
<!--            </div>-->
<!--            <div class="tm-paging-wrapper">-->
<!--                <span class="d-inline-block mr-3">Page</span>-->
<!--                <nav class="tm-paging-nav d-inline-block">-->
<!--                    <ul>-->
<!--                        <li class="tm-paging-item active">-->
<!--                            <a href="#" class="mb-2 tm-btn tm-paging-link">1</a>-->
<!--                        </li>-->
<!--                        <li class="tm-paging-item">-->
<!--                            <a href="#" class="mb-2 tm-btn tm-paging-link">2</a>-->
<!--                        </li>-->
<!--                        <li class="tm-paging-item">-->
<!--                            <a href="#" class="mb-2 tm-btn tm-paging-link">3</a>-->
<!--                        </li>-->
<!--                        <li class="tm-paging-item">-->
<!--                            <a href="#" class="mb-2 tm-btn tm-paging-link">4</a>-->
<!--                        </li>-->
<!--                    </ul>-->
<!--                </nav>-->
<!--            </div>-->
<!--        </div>-->
        <div class="data-container row tm-row">
        </div>
        <div id="pagination-container" class="row tm-row">
            <article class="col-12 col-md-4 tm-post" style="width:300px"> </article>
        </div>
    </main>
</div>
<script type="text/javascript">

    $(document).ready(function(){
        $('#pagination-container').pagination({
            dataSource: function(done) {
                $.ajax({
                    type: 'GET',
                    url: '/api/books',
                    success: function(response) {
                        done(response);
                    }
                });
            },
            locator: 'items',
            totalNumber: 100,
            pageSize: 2,
            showPageNumbers: true,
            showPrevious: true,
            showNext: true,
            showNavigator: true,
            className: 'paginationjs-theme-blue',
            //showFirstOnEllipsisShow: true,
            //showLastOnEllipsisShow: true,

            //     callback: function(data, pagination) {
            //     var html = simpleTemplating(data);
            //     $('.data-container').html(html);
            // }
            ajax: {
                beforeSend: function () {
                    $('#pagination-container').prev().html('Loading data for books ...');
                }
            },
            callback: function (response, pagination) {
                // window.console && console.log(22, response, pagination);
                var dataHtml = '<hr class="tm-hr-primary">';
                $.each(response, function (index, item) {
                    dataHtml += '<a href="/books/' + item.id + '"'
                        +'class="effect-lily tm-post-link tm-pt-60">'
                        +'<div class="tm-post-link-inner">'
                        +'<img src=' + item.url + ' style="width: 300px; height: 400px;" alt="Image"'
                        +'class="img-fluid">'
                        +'</div>'
                        +'<span class="position-absolute tm-new-badge">Recommended</span>'
                        +'<h1 class="tm-pt-30 tm-color-primary tm-post-title">' + item.name + '</h1>'
                        +'<span class="tm-color-primary">' + 'Author: ' + item.author + '</span>'
                        + '<br/>'
                        +'<span>' + 'Stock: ' + item.stock + '</span>'
                        +'<br/>'
                        +'<span>' + 'Rating: ' + item.rating + '</span>'
                        + '<hr/>'
                        +'</a>'
                        // +'<div class="d-flex justify-content-between tm-pt-45">'
                        // +'<span class="tm-color-primary">' + item.author + '</span>'
                        // +'</div>'
                        +'<hr>'
                        +'<div class="d-flex justify-content-between">'
                        // +'<span>' + item.stock + '</span>'
                        // +'<span>' + item.rating + '</span>'
                        +'</div>'
                    //+'</article>'
                    // dataHtml += '<li>' + item.name + '</li>';
                });
                //dataHtml += '</article>';
                $('#pagination-container').prev().html(dataHtml);
            }
        })
    })
// $('#pagination-container').pagination({
// dataSource: [1, 2, 3, 4, 5, 6, 7 , 195],
// callback: function(data, pagination) {
// // template method of yourself
// var html = simpleTemplating(data);
// $('#data-container').html(html);
// }
// })

// $(document).ready(function(){
//     $('#pagination-container').pagination({
//     dataSource: [1,2,3,4,5,6],
//         pageSize: 3,
//     callback: function(data, pagination) {
//         var html = simpleTemplating(data);
//         $('#data-container').html(html);
//     }
// })
// })
//
// function simpleTemplating(data) {
//     let html = '<ul>';
//     $.each(data, function(index, item){
//         html += '<li>'+ item +'</li>';
//     });
//     html += '</ul>';
//     return html;
// }


</script>

<!--<script type="text/javascript" src="js/jquery.min.js"></script>-->
<!--<script type="text/javascript" src="../static/javascript-jquery.js"></script>-->
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script  type="text/javascript" src="https://pagination.js.org/dist/2.1.5/pagination.min.js"></script>
<script  type="text/css" src="https://pagination.js.org/dist/2.1.5/pagination.js"></script>
</body>
</html>